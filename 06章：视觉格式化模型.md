**目录：**

- [6. 视觉格式化模型](#6-视觉格式化模型)
  - [6.1. 视觉格式化模型简介](#61-视觉格式化模型简介)
    - [6.1.1. 视口](#611-视口)
    - [6.1.2. 包含块](#612-包含块)
  - [6.2. 控制盒子生成](#62-控制盒子生成)
    - [6.2.1. 块级元素和块级盒子](#621-块级元素和块级盒子)
      - [6.2.1.1. 匿名块盒子](#6211-匿名块盒子)
    - [6.2.2. 行内级元素盒行内盒子](#622-行内级元素盒行内盒子)
      - [6.2.2.1. 匿名行内盒子](#6221-匿名行内盒子)
    - [6.2.3. display 属性](#623-display-属性)
  - [6.3. 定位方案](#63-定位方案)
    - [6.3.1. position 属性](#631-position-属性)
    - [6.3.2. 盒子偏移](#632-盒子偏移)
  - [6.4. 正常流](#64-正常流)
    - [6.4.1. 块格式化上下文](#641-块格式化上下文)
    - [6.4.2. 行内格式上下文](#642-行内格式上下文)
    - [6.4.3. 相对定位](#643-相对定位)
  - [6.5. 浮动](#65-浮动)
    - [6.5.1. float 属性](#651-float-属性)
    - [6.5.2. clear 属性](#652-clear-属性)
  - [6.6. 绝对定位](#66-绝对定位)
    - [6.6.1. 固定定位](#661-固定定位)
  - [6.7. display, position 和 float 之间的关系](#67-display-position-和-float-之间的关系)
  - [6.8. 对比正常流，浮动和绝对定位](#68-对比正常流浮动和绝对定位)
  - [6.9. 分层显示](#69-分层显示)
  - [6.10. 文本方向](#610-文本方向)

# 6. 视觉格式化模型

## 6.1. 视觉格式化模型简介

本章和下一章描述了视觉格式化模型：用户代理如何处理视觉媒体的文档树。

在视觉格式化模型中，文档树中的每个元素都会根据盒模型生成 0 个或多个盒子。这些盒子的布局受以下因素制约。

- 盒子的尺寸和类型。
- 定位方案（正常流动、浮动和绝对定位）。
- 文档树中元素之间的关系。
- 外部信息（例如，视口尺寸、图像的固有尺寸等）。

视觉格式化模型并没有指定格式化的所有方面（例如，它没有指定字母间距算法）。符合要求的用户代理可能会对本规范未涵盖的那些格式化问题采取不同的行为。

### 6.1.1. 视口

连续媒体的用户代理通常为用户提供一个视口（屏幕上的一个窗口或其他观察区域），用户通过它来查阅文档。当视口被调整大小时，用户代理可能会改变文档的布局（见初始包含块）。

当视口小于渲染文档的画布的面积时，用户代理应该提供一个滚动机制。每个画布最多只有一个视口，但用户代理可以渲染到一个以上的画布上（即提供同一文档的不同视图）。

### 6.1.2. 包含块

在 CSS 2.2 中，许多盒子的位置和大小都是相对于一个叫做包含块的矩形盒子的边缘计算的。一般来说，生成盒子作为后代盒子的包含块；我们说一个盒子为其后代盒子 "建立" 了包含块。短语 "盒子的包含块" 是指 "盒子所处的包含块"，而不是它所生成的那个。

每个盒子都有一个相对于其包含块的位置，但它并不被这个包含块所限制；它可以溢出。

下一章将描述如何计算一个包含块的尺寸的细节。

## 6.2. 控制盒子生成

下面的章节描述了在 CSS 2.2 中可能生成的盒子的类型。一个盒子的类型部分地影响了它在视觉格式化模型中的行为。下面描述的'display'属性指定了一个盒子的类型。

'display' 属性的某些值会使源文档中的一个元素生成一个 **主盒子**，该主盒子包含了后代盒子和生成的内容，以及任何定位方案中涉及的盒子。一些元素可能在主盒子之外产生额外的盒子: list-item 元素。这些额外的盒子是相对于主盒子放置的。

### 6.2.1. 块级元素和块级盒子

**块级元素** --源文档中那些在视觉上被格式化为块的元素（例如，段落）--是产生块级主盒子的元素。使元素成为块级的 'display' 属性的值包括：'block'、'list-item,' 和 'table'。**块级盒子** 是参与块格式化上下文的盒子。

在 CSS 2.2 中，一个块级盒子也是一个块容器盒子，除非它是一个表格盒子或一个替换性元素的主盒子。一个 **块容器盒子** 要么只包含块级盒子，要么建立一个行内格式化上下文，因此只包含行内级盒子。一个主盒子是块容器盒子的元素是一个 **块容器元素**。使一个非替换性元素生成一个块容器的 'display' 属性的值包括 'block'、'list-item'和'inline-block'。并非所有的块容器盒子都是块级盒子：非替换性行内块和非替换性表格单元格是块容器，但不是块级。同时也是块容器的块级盒子被称为 **块盒子**。

这三个术语 "块级盒子"、"块容器盒子 "和 "块盒子" 有时在不明确的情况下被缩写为 "块"。

#### 6.2.1.1. 匿名块盒子

在这样的一个文档中：

```html
<div>
  Some text
  <p>More text</p>
</div>
```

(假设 DIV 和 P 都有'display: block'），DIV 看起来既有行内内容又有块内容。为了便于定义格式，我们假设 "一些文本" 周围有一个匿名的块盒子。

换句话说：如果一个块容器盒子（比如上面为 DIV 生成的）里面有一个块级盒子（比如上面的 P），那么我们强制它里面只有块级盒子。

当一个行内盒子包含一个常规流的块级盒子时，行内盒子（及其在同一行内盒子的行内祖先盒子）会围绕块级盒子（以及任何连续的或仅由可折叠的空白和/或脱离常规流的元素分隔的块级兄弟盒子）断开，将行内盒子分割成两个盒子（即使任何一边是空的），在块级盒子的两侧各一个。断裂前和断裂后的行内盒子被包围在匿名块级盒子中，而块级盒子成为这些匿名盒子的兄弟盒子。当这样的行内盒子受到相对定位的影响时，任何产生的平移也会影响到行内盒子中包含的块级盒子。

这个模式将适用于以下例子，如果以下规则：

```css
p {
  display: inline;
}

span {
  display: block;
}
```

被用于该 HTML 文档:

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<head>
  <title>匿名文本被一个块阻断</title>
</head>
<body>
  <p>
    这是在 span 之前的匿名文本。
    <span>这是span的内容</span>
    这是在 span 之后的匿名文本。
  </p>
</body>
```

P 元素包含一大块（C1）匿名文本，后面是一个块级元素，后面是另一大块（C2）匿名文本。由此产生的盒子将是一个代表 BODY 的块盒子，包含 C1 周围的一个匿名块盒子：SPAN 块盒子，以及 C2 周围的另一个匿名块盒子。

匿名盒子的属性是从包围的非匿名盒子中继承的（例如，在 "匿名块盒子" 小节标题下的例子中，DIV 的属性）。非继承的属性有其初始值。例如，匿名盒子的字体是继承自 DIV 的，但外边距将是 0。

在元素上设置的导致生成匿名块盒子的属性仍然适用于该元素的盒子和内容。例如，如果在上例中的 P 元素上设置了边框，那么边框将围绕 C1（在行末开放）和 C2（在行首开放）绘制。

一些用户代理以其他方式在包含块的行内上实现边框，例如，通过将这些嵌套的块包裹在 "匿名行盒子 "内，从而在这些行盒子周围绘制行内边框。由于 CSS1 和 CSS2 没有定义这种行为，只有 CSS1 和 CSS2 的用户代理可以实现这种替代模型，并且仍然声称符合 CSS 2.2 的这一部分。这不适用于本规范发布后开发的用户代理。

在解析引用它的百分数值时，匿名块盒子会被忽略：会使用最接近的非匿名的祖先盒子。例如，如果上面 DIV 内的匿名块盒子的子盒子需要知道其包含块的高度来解决百分比高度，那么它将使用 DIV 形成的包含块的高度，而不是匿名块盒子的高度。

### 6.2.2. 行内级元素盒行内盒子

**行内级元素** 是源文档中那些不形成新的内容块的元素；内容分布在行中（例如，段落中的强调文本，行内图像，等等）。下列 "display" 属性的值使元素成为行内级："inline"、"inline-table" 和 "inline-block"。行内级元素产生 **行内级盒子**，这是参与行内格式化上下文的盒子。

一个 **行内盒子** 是一个既是行内级又是其内容参与其包含的行内格式化上下文的盒子。一个 "display" 值为 "inline" 的非替换性元素会产生一个行内盒子。不是行内盒子的行内级盒子（如替换性行内级元素、行内块元素和行内表格元素）被称为 **原子行内级盒子**，因为它们作为一个单一的不透明盒子参与其行内格式化上下文。

#### 6.2.2.1. 匿名行内盒子

任何直接包含在块容器元素内的文本（不在内联元素内）必须被视为匿名行内元素。

在一个具有这样的 HTML 标记的文档中:

```html
<p>
  一些
  <em>强调的</em>
  文本
</p>
```

`<p>` 产生了一个块盒子，里面有几个行内盒子。用来“强调”的盒子是由行内元素（`<em>`）生成的行内盒子，但其他的盒子（"一些"和 "文本"）是由块级元素（`<p>`）生成的行内盒子。后者被称为匿名行内盒子，因为它们没有一个相关的行内级元素。

这种匿名行内盒子从其父块盒子继承可继承的属性。非继承的属性有其初始值。在这个例子中，匿名行内盒子的颜色是从 P 中继承的，但背景是透明的。

根据'white-space'属性，随后会被折叠掉的空白内容不会产生任何匿名行内盒子。

如果从上下文中可以清楚地知道是指哪种类型的匿名盒子，匿名行内盒子和匿名块盒子在本规范中都被简单地称为匿名盒子。

在格式化表格时，还有更多类型的匿名盒子出现。

### 6.2.3. display 属性

| 属性名   | display  |
| -------- | -------- | ----- | --------- | ------------ | ----- | ------------ | --------------- | ------------------ | ------------------ | --------- | ------------------ | ------------ | ---------- | ------------- | ---- | -------- |
| 值       | `inline  | block | list-item | inline-block | table | inline-table | table-row-group | table-header-group | table-footer-group | table-row | table-column-group | table-column | table-cell | table-caption | none | inherit` |
| 初始值   | inline   |
| 适用元素 | 所有元素 |
| 可继承性 | 否       |
| 百分数值 | N/A      |
| 适用媒体 | 所有     |
| 计算值   | 参见本书 |

此属性的值有以下含义。

- block
  这个值会使一个元素产生一个主块盒子。

- inline-block
  这个值会使一个元素产生一个主要的行内块容器。(这个盒子的内部被格式化为一个块级，而元素本身被格式化为一个原子行内级盒子。)

- inline
  这个值使一个元素产生一个或多个行内盒子。

- list-item
  这个值使一个元素（例如 HTML 中的 LI）产生一个主块盒子和一个标记盒子。

- none
  这个值使一个元素不出现在格式化结构中（即在视觉媒体中，该元素不产生盒子，对布局没有影响）。后代元素也不产生任何盒子；该元素及其内容完全从格式化结构中移除。这种行为不能通过在子元素上设置'display'属性而被推翻。
  请注意，"none" 的显示并不创建一个不可见的方框；它根本就不创建任何方框。CSS 包括一些机制，使一个元素能够在格式化结构中生成影响格式化但本身不可见的框。详情请参考可见性一节。

- table, inline-table, table-row-group, table-column, table-column-group, table-header-group, table-footer-group, table-row, table-cell, and table-caption
  这些值使一个元素表现得像一个表格元素（受制于关于表格的章节中描述的限制）。

计算值与指定值相同，除了定位和浮动元素（见 display, position 和 float 之间的关系）和根元素。对于根元素来说，计算值会按照 display, position 和 float 之间的关系一节中的描述来改变。

注意，虽然 'display' 的初始值是 'inline'，但用户代理的默认样式表中的规则可能会覆盖这个值。

一些关于 display 属性的例子：

```css
p {
  display: block;
}
em {
  display: inline;
}
li {
  display: list-item;
}
img {
  display: none;
} /* 不会显示图片 */
```

## 6.3. 定位方案

在 CSS 2.2 中，一个盒子可以按照三种定位方案来放置。

1. **正常流**。在 CSS 2.2 中，正常流包括块级盒子的块格式化，行内级盒子的行内格式化，以及块级和行内级盒子的相对定位。

2. **浮动**。在浮动模型中，一个盒子首先按照正常流程布置，然后从正常流中取出并尽可能向左或向右移动。内容可以沿着浮动的一侧流动。

3. **绝对定位**。在绝对定位模型中，一个盒子被完全从正常流中移除（它对后面的兄弟元素没有影响），并相对于一个包含块分配一个位置。

如果一个元素是浮动的，绝对定位的，或者是根元素，它就被称为 **脱离正常流(out of flow)**。如果一个元素不是脱离正常流的，则称为在 **正常流中(in-flow)**。一个元素 A 的流是由 A 和所有在正常流中元素组成的集合，这些元素的最近的脱离正常流的祖先元素是 A。

注意。CSS 2.2 的定位方案可以帮助作者使他们的文档更容易访问，因为他们可以避免用于布局效果的标记技巧（例如，看不见的图像）。

### 6.3.1. position 属性

'position' 和 'float' 属性决定了哪个 CSS 2.2 定位算法被用来计算一个盒子的位置。

| 属性名   | position |
| -------- | -------- | -------- | -------- | ----- | -------- |
| 值       | `static  | relative | absolute | fixed | inherit` |
| 初始值   | static   |
| 适用元素 | 所有元素 |
| 可继承性 | 否       |
| 百分数值 | N/A      |
| 适用媒体 | 视觉     |
| 计算值   | 参见规范 |

此属性的值有以下含义：

- **static**
  该盒子是一个正常的盒子，按照正常流程放置。'top', 'bottom', 'left', 'right' 属性不适用。

- **relative**
  盒子的位置是根据正常流计算的（这被称为正常流中的位置）。然后盒子相对于它的正常位置进行偏移。当一个盒子 B 被相对定位时，后面的盒子的位置被计算出来，就像 B 没有被偏移一样。position:relative 对 table-row-group、table-header-group、table-footer-group、table-row、table-column-group、table-column、table-cell 和 table-caption 元素的影响未定义。

- **absolute**
  盒子的位置（可能还有大小）是用 'top', 'right', 'bottom' 和 'left' 属性指定的。这些属性指定了相对于盒子的包含块的偏移量。绝对定位的盒子被从正常流中取出。这意味着它们对后来的兄弟元素的布局没有影响。另外，尽管绝对定位盒子有外边距，但它们不会与任何其他外边距一起折叠。

- **fixed**
  盒子的位置是根据绝对模型计算的，但除此之外，盒子相对于某些参考物是固定的。与绝对模型一样，盒子的外边距不会与任何其他外边距一起折叠。在手持、投影、屏幕、TTY 和电视媒体类型的情况下，盒子相对于视口是固定的，滚动时不会移动。在打印媒体类型的情况下，盒子在每个页面上都被呈现，并且相对于页面盒子是固定的，即使页面是通过视口看到的（例如，在打印预览的情况下）。对于其他媒体类型，呈现方式是未定义的。作者可能希望以一种依赖于媒体的方式来指定 fixed。例如，作者可能希望一个方框在屏幕上保持在视口的顶部，但在每个打印页的顶部则不需要。这两种规格可以通过使用@media 规则来区分，如：

```css
@media screen {
  h1#first {
    position: fixed;
  }
}
@media print {
  h1#first {
    position: static;
  }
}
```

用户代理可以将根元素上的位置视为 "static"。

### 6.3.2. 盒子偏移

如果一个元素的'position'属性有一个'static'以外的值，那么它就被称为定位了。被定位的元素会产生被定位的盒子，根据四个属性来放置：

| 属性名   | top                                                                                 |
| -------- | ----------------------------------------------------------------------------------- | ------------ | ---- | -------- |
| 值       | `<length>                                                                           | <pencentage> | auto | inherit` |
| 初始值   | auto                                                                                |
| 适用元素 | 定位元素                                                                            |
| 可继承性 | 否                                                                                  |
| 百分数值 | 相对于包含块的高度                                                                  |
| 适用媒体 | 视觉                                                                                |
| 计算值   | 如果指定为长度，则为相应的绝对长度；如果指定为百分数值，则为指定值；否则为 'auto'。 |

这个属性指定了一个绝对定位的盒子的顶部边缘在该盒子的包含块的顶部边缘之下的偏移量。对于相对定位的盒子，偏移是相对于盒子本身的顶部边缘而言的（即，盒子在正常流程中被赋予一个位置，然后根据这些属性从该位置偏移）。

| 属性名   | right                                                                               |
| -------- | ----------------------------------------------------------------------------------- | ------------ | ---- | -------- |
| 值       | `<length>                                                                           | <pencentage> | auto | inherit` |
| 初始值   | auto                                                                                |
| 适用元素 | 定位元素                                                                            |
| 可继承性 | 否                                                                                  |
| 百分数值 | 相对于包含块的宽度                                                                  |
| 适用媒体 | 视觉                                                                                |
| 计算值   | 如果指定为长度，则为相应的绝对长度；如果指定为百分数值，则为指定值；否则为 'auto'。 |

像'top'一样，但指定了一个盒子的右边缘向该盒子的包含块的右边缘的左边偏移的程度。对于相对位置的盒子，偏移是相对于盒子本身的右边缘而言的。

| 属性名   | bottom                                                                              |
| -------- | ----------------------------------------------------------------------------------- | ------------ | ---- | -------- |
| 值       | `<length>                                                                           | <pencentage> | auto | inherit` |
| 初始值   | auto                                                                                |
| 适用元素 | 定位元素                                                                            |
| 可继承性 | 否                                                                                  |
| 百分数值 | 相对于包含块的高度                                                                  |
| 适用媒体 | 视觉                                                                                |
| 计算值   | 如果指定为长度，则为相应的绝对长度；如果指定为百分数值，则为指定值；否则为 'auto'。 |

和'top'一样，但指定一个盒子的底部边距边缘在该盒子包含的块的底部以上偏移的程度。对于相对定位的盒子，偏移量是相对于盒子本身的底边而言的。

| 属性名   | left                                                                                |
| -------- | ----------------------------------------------------------------------------------- | ------------ | ---- | -------- |
| 值       | `<length>                                                                           | <pencentage> | auto | inherit` |
| 初始值   | auto                                                                                |
| 适用元素 | 定位元素                                                                            |
| 可继承性 | 否                                                                                  |
| 百分数值 | 相对于包含块的宽度                                                                  |
| 适用媒体 | 视觉                                                                                |
| 计算值   | 如果指定为长度，则为相应的绝对长度；如果指定为百分数值，则为指定值；否则为 'auto'。 |

和'top'一样，但指定一个盒子的左边距边缘偏移到该盒子所包含的块的左边缘的右边有多远。对于相对位置的盒子，偏移是相对于盒子本身的左边缘而言的。

这四个属性的值有以下含义：

- **<length>**
  偏移量是与参考边缘的一个固定距离。允许使用负值。

- **<percentage>**
  偏移是包含块的宽度（对于 "左 "或 "右"）或高度（对于 "顶 "和 "底"）的百分比。允许使用负值。

- **auto**
  对于非替换的元素，这个值的效果取决于哪些相关属性的值也是'auto'。详见关于绝对定位的非替换元素的宽度和高度的章节。对于被替换的元素，这个值的效果只取决于被替换内容的内在尺寸。详见绝对定位的被替换元素的宽度和高度部分。

## 6.4. 正常流

正常流的盒子属于一个格式化上下文，在 CSS 2.2 中可以是表格、块或行内。在未来的 CSS 级别中，将引入其他类型的格式化上下文。块级盒子属于块格式化上下文。行内级盒子参与到行内格式化上下文中。表格的格式化上下文在关于表格的章节中描述。

### 6.4.1. 块格式化上下文

浮动、绝对定位的元素、不是块状框的块状容器（如 inline-blocks、table-cell 和 table-captions），以及 "溢出 "不是 "可见 "的块状框（除非该值已被传播到视口）为其内容建立新的块状格式化上下文。

在一个块格式化上下文中，方框是一个接一个垂直排列的，从包含块的顶部开始。两个同级方框之间的垂直距离由 "边距 "属性决定。在块格式化上下文中，相邻的块级方框之间的垂直边距会折叠。

在块格式化上下文中，每个盒子的左外边缘都会接触到包含块的左边缘（对于从右到左的格式化，右边缘会接触）。即使在有浮动的情况下也是如此（尽管一个盒子的线框可能会因为浮动而缩小），除非该盒子建立了一个新的块格式化上下文（在这种情况下，盒子本身可能会因为浮动而变得更窄）。

关于分页媒体的分页信息，请参考允许分页的部分。

### 6.4.2. 行内格式上下文

内联格式化上下文是由一个不包含块级框的块容器框建立的。在一个内联格式化环境中，方框是水平排列的，一个接一个，从包含块的顶部开始。这些方框之间的水平边距、边框和填充物都得到尊重。这些方框可以用不同的方式在垂直方向上对齐：它们的底部或顶部可以对齐，或者它们内部的文本基线可以对齐。包含形成一条线的方框的矩形区域被称为线框。

线条框的宽度由一个包含块和浮动的存在决定。线条框的高度由线条高度计算一节中给出的规则决定。

一个线框的高度总是足以容纳它所包含的所有线框。然而，它可能比它所包含的最高的盒子要高（例如，如果盒子被对齐，使基线排成一行）。当一个盒子 B 的高度小于包含它的线框的高度时，线框内 B 的垂直对齐由'垂直对齐'属性决定。当几个内联级的方框不能在水平方向上适合于一个行框时，它们会被分配到两个或多个垂直堆叠的行框中。因此，一个段落是一个垂直堆叠的行框。行框的堆叠没有垂直分隔（除非在其他地方指定），而且它们从不重叠。

一般来说，线框的左边缘触及其包含块的左边缘，右边缘触及其包含块的右边缘。然而，浮动框可能会出现在包含块边缘和线框边缘之间。因此，尽管同一内联格式的行框通常具有相同的宽度（即包含块的宽度），但如果可用的水平空间因浮动而减少，它们的宽度就会不同。同一内联格式化背景下的行框通常在高度上有所不同（例如，一行可能包含一个高的图像，而其他行只包含文本）。

当一行中的内联级框的总宽度小于包含它们的行框的宽度时，它们在行框中的水平分布由'text-align'属性决定。如果该属性的值为'justify'，则用户代理可能会将行内框（但不包括 inline-table 和 inline-block 框）中的空格和文字也拉伸。

当一个内联框超过一个行框的宽度时，它就会被分割成几个框，这些框被分布在几个行框中。如果一个内联框不能被分割（例如，如果内联框包含一个字符，或者语言的特定断字规则不允许在内联框内断字，或者内联框受到 nowrap 或 pre 的白空间值的影响），那么内联框会溢出行框。

当一个内联框被分割时，边距、边框和填充在发生分割的地方（或在任何分割处，当有几个分割时）没有视觉效果。

由于双向文本处理，内联框也可能在同一行框内被分割成几个框。

行框是根据需要创建的，以便在内联格式化背景下容纳内联级内容。不包含文本、不保留空白、不包含具有非零边距、填充或边框的内联元素，以及不包含其他内联内容（如图像、内联块或内联表），并且不以保留的换行结束的行框必须被视为零高度的行框，以便确定其内部任何元素的位置，并且必须被视为不存在任何其他目的。

下面是一个内联框结构的例子。以下段落（由HTML块级元素P创建）包含匿名文本，其中穿插了元素EM和STRONG：

```html
<P>若干个 <EM>强调的词语</EM> 出现<STRONG>在这个</STRONG>句子，伙计。</P>
```

P元素生成了一个块状框，其中包含五个内联框，其中三个是匿名的：

- 匿名："几个"
- EM："强调的词语"
- 匿名："出现"
- STRONG："在这个"
- 匿名："句子，伙计。"

为了格式化该段落，用户代理将五个方框流入行框。在这个例子中，为P元素生成的框建立了行框的包含块。如果包含区块足够宽，所有的内联框都可以放入一个行框中:

```
有几个强调的词语出现在这个句子中，伙计。
```

如果不是，内联框将被拆开，分布在几个行框中。前面的段落可能会被分割如下。

```
有几个强调的词语出现在
在这句话中，伙计。
```

或像这样:

```
有几个强调的  
词语出现在这个 
句子，伙计。
```

在前面的例子中，EM框被分割成两个EM框（称之为 "split1 "和 "split2"）。在split1之后或split2之前，边距、边框、填充或文本装饰都没有可见效果。

### 6.4.3. 相对定位

一旦一个盒子按照正常流程布局或浮动，它就可以相对于这个位置进行移动。这就是所谓的相对定位。以这种方式偏移一个盒子（B1），对后面的盒子（B2）没有影响。B2的位置就像B1没有被偏移一样，在B1的偏移被应用后，B2不会被重新定位。这意味着，相对定位可能会导致方框重叠。然而，如果相对定位导致 "溢出：自动 "或 "溢出：滚动 "框有溢出，UA必须允许用户访问这些内容（在其偏移位置），通过创建滚动条，可能会影响布局。

一个相对定位的盒子会保持其正常的流量大小，包括换行和原来为其保留的空间。关于包含块的章节解释了相对定位的方框何时建立一个新的包含块。

对于相对定位的元素，"左 "和 "右 "水平移动方框，而不改变其大小。左 "将盒子向右移动，而 "右 "将它们向左移动。因为盒子不会因为'左'或'右'而被分割或拉伸，所以使用的值总是：左=-右。

如果'左'和'右'都是'自动'（它们的初始值），使用的值是'0'（也就是说，盒子保持在它们的原始位置）。

如果'left'是'auto'，它的使用值是减去'right'的值（也就是说，盒子向左移动的值是'right'的值）。

如果'右'被指定为'自动'，它的使用值是减去'左'的值。

如果'左'和'右'都不是'自动'，位置就会被过度限制，其中一个必须被忽略。如果包含块的'方向'属性是'ltr'，'左'的值就会赢，'右'就会变成-'左'。如果包含块的'方向'是'rtl'，'右'获胜，'左'被忽略。

例子。以下三条规则是等价的。

```css
div.a8 { position: relative; direction: ltr; left: -1em; right: auto }
div.a8 { position: relative; direction: ltr; left: auto; right: 1em }
div.a8 { position: relative; direction: ltr; left: -1em; right: 5em }
```

top'和'bottom'属性将相对定位的元素向上或向下移动，而不改变其大小。顶部 "将盒子向下移动，而 "底部 "将它们向上移动。因为盒子不会因为'top'或'bottom'而被分割或拉伸，所以使用的值总是：top = -bottom。如果两者都是'自动'，它们的使用值都是'0'。如果其中一个是 "自动"，它就成为另一个的负值。如果两者都不是 "自动"，"底 "就会被忽略（即 "底 "的使用值将减去 "顶 "的值）。

注意。相对定位的盒子的动态移动可以在脚本环境中产生动画效果（另见'可见性'属性）。虽然相对定位可以作为上标和下标的一种形式，但行高不会自动调整以考虑到定位。更多信息请参见行高计算的描述。

在比较正常流、浮动和绝对定位的章节中提供了相对定位的例子。

## 6.5. 浮动

浮动是一个在当前行中向左或向右移动的盒子。浮动（或 "浮动 "或 "浮动 "框的最有趣的特征是，内容可以沿其侧面流动（或被 "清除 "属性禁止这样做）。内容在左浮动框的右侧流动，在右浮动框的左侧流动。下面是关于浮动定位和内容流动的介绍；关于浮动行为的确切规则在'浮动'属性的描述中给出。

一个浮动框会向左或向右移动，直到它的外边缘接触到包含块的边缘或另一个浮动框的外边缘。如果有一个线框，浮动框的外顶部与当前线框的顶部对齐。

如果没有足够的水平空间容纳浮动，它将被向下移动，直到它适合或没有更多的浮动存在。

由于浮动不在流程中，在浮动框之前和之后创建的非定位块框垂直流动，就像浮动不存在一样。然而，在浮子旁边创建的当前和后续的线框会根据需要缩短，以便为浮子的边框腾出空间。

当存在一个满足所有这四个条件的垂直位置时，一个线框就在一个浮动的旁边。(a)在线框的顶部或下面，(b)在线框的底部或上面，(c)在浮动的顶部边缘以下，和(d)在浮动的底部边缘以上。

注意：这意味着外高为零或外高为负的浮动体不会缩短线框。

如果缩短后的行框太小，不能容纳任何内容，那么行框就会向下移动（并且重新计算其宽度），直到有内容适合或者没有更多的浮子存在。在浮动框之前的当前行中的任何内容都会在浮动框的另一侧的同一行中回流。换句话说，如果在遇到适合剩余行框空间的左浮动之前，行内的内联框被放置在行内，左浮动被放置在该行，与行框的顶部对齐，然后已经在行内的内联框被相应地移动到浮动的右边（右边是左浮动的另一边），反之，rtl和右浮动也是如此。

表格的边框、被替换的块级元素、或正常流程中建立新的块格式化上下文的元素（比如 "溢出 "不是 "可见 "的元素）的边框不得与元素本身在同一块格式化上下文中的任何浮动重叠。如果有必要，实现者应该通过将其放置在任何前面的浮子下面来清除上述元素，但如果有足够的空间，可以将其放置在这些浮子的旁边。他们甚至可以使上述元素的边框比第10.3.3节所定义的更窄。CSS2没有定义UA何时可以将所述元素放在浮动的旁边，也没有定义所述元素可以变窄多少。

### 6.5.1. float 属性

### 6.5.2. clear 属性

## 6.6. 绝对定位

在绝对定位模型中，一个盒子相对于其包含的块是明确偏移的。它被完全从正常流程中移除（它对后来的兄弟姐妹没有影响）。一个绝对定位的盒子为正常流的子代和绝对（但不是固定）定位的后代建立了一个新的包含块。然而，一个绝对定位的元素的内容并不在任何其他盒子周围流动。它们可能会掩盖另一个盒子的内容（或者自己被掩盖），这取决于重叠的盒子的堆叠级别。

本规范中对绝对位置元素（或其盒子）的引用意味着该元素的 "位置" 属性值为 "绝对" 或 "固定"。

### 6.6.1. 固定定位

## 6.7. display, position 和 float 之间的关系

## 6.8. 对比正常流，浮动和绝对定位

## 6.9. 分层显示

## 6.10. 文本方向
